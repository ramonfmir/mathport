{"trans_local_homeomorph_apply":
 "/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `local_homeomorph.trans -/\n/-\nCopyright (c) 2022 Floris van Doorn, Heather Macbeth. All rights reserved.\nReleased under Apache 2.0 license as described in the file LICENSE.\nAuthors: Floris van Doorn, Heather Macbeth\n-/\n/-- Compute the composition of two local homeomorphisms induced by fiberwise linear\nequivalences. -/\ntheorem trans_local_homeomorph_apply (hU : IsOpen U) (hÏ† : ContinuousOn (fun x => Ï† x : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U)\n    (h2Ï† : ContinuousOn (fun x => (Ï† x).symm : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U) (hU' : IsOpen U')\n    (hÏ†' : ContinuousOn (fun x => Ï†' x : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U')\n    (h2Ï†' : ContinuousOn (fun x => (Ï†' x).symm : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U') (b : B) (v : F) :\n    (local_homeomorph.trans (fiberwise_linear.local_homeomorph Ï† hU hÏ† h2Ï†)\n          (fiberwise_linear.local_homeomorph Ï†' hU' hÏ†' h2Ï†'))\n        âŸ¨b, vâŸ© =\n      âŸ¨b, Ï†' b (Ï† b v)âŸ© :=\n  rfl\n#align trans_local_homeomorph_apply trans_local_homeomorph_apply\n\n",
 "target_trans_local_homeomorph":
 "/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `local_homeomorph.trans -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/-- Compute the target of the composition of two local homeomorphisms induced by fiberwise linear\nequivalences. -/\ntheorem target_trans_local_homeomorph (hU : IsOpen U) (hÏ† : ContinuousOn (fun x => Ï† x : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U)\n    (h2Ï† : ContinuousOn (fun x => (Ï† x).symm : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U) (hU' : IsOpen U')\n    (hÏ†' : ContinuousOn (fun x => Ï†' x : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U')\n    (h2Ï†' : ContinuousOn (fun x => (Ï†' x).symm : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U') :\n    (local_homeomorph.trans (fiberwise_linear.local_homeomorph Ï† hU hÏ† h2Ï†)\n          (fiberwise_linear.local_homeomorph Ï†' hU' hÏ†' h2Ï†')).target =\n      lower_set.prod (U âˆ© U') univ :=\n  by\n  dsimp only [fiberwise_linear.local_homeomorph]\n  mfld_set_tac\n#align target_trans_local_homeomorph target_trans_local_homeomorph\n\n",
 "source_trans_local_homeomorph":
 "/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `local_homeomorph.trans -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/-- Compute the source of the composition of two local homeomorphisms induced by fiberwise linear\nequivalences. -/\ntheorem source_trans_local_homeomorph (hU : IsOpen U) (hÏ† : ContinuousOn (fun x => Ï† x : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U)\n    (h2Ï† : ContinuousOn (fun x => (Ï† x).symm : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U) (hU' : IsOpen U')\n    (hÏ†' : ContinuousOn (fun x => Ï†' x : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U')\n    (h2Ï†' : ContinuousOn (fun x => (Ï†' x).symm : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U') :\n    (local_homeomorph.trans (fiberwise_linear.local_homeomorph Ï† hU hÏ† h2Ï†)\n          (fiberwise_linear.local_homeomorph Ï†' hU' hÏ†' h2Ï†')).source =\n      lower_set.prod (U âˆ© U') univ :=\n  by\n  dsimp only [fiberwise_linear.local_homeomorph]\n  mfld_set_tac\n#align source_trans_local_homeomorph source_trans_local_homeomorph\n\n",
 "mem_smooth_fiberwise_linear_iff":
 "/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â‰ƒL[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n-- the hard work has been extracted to `locality_auxâ‚` and `locality_auxâ‚‚`\n@[simp]\ntheorem mem_smooth_fiberwise_linear_iff (e : LocalHomeomorph (B Ã— F) (B Ã— F)) :\n    e âˆˆ smooth_fiberwise_linear B F IB â†”\n      âˆƒ (Ï† : B â†’ Â«expr â‰ƒL[ ] Â» F ğ•œ F)(U : Set B)(hU : IsOpen U)(hÏ† :\n        smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => Ï† x : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F) U)(h2Ï† :\n        smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => (Ï† x).symm : B â†’ Â«expr â†’L[ ] Â» F ğ•œ F)\n          U),\n        e.eq_on_source (fiberwise_linear.local_homeomorph Ï† hU hÏ†.continuous_on h2Ï†.continuous_on) :=\n  show e âˆˆ Set.unionáµ¢ _ â†” _ by\n    simp only [mem_Union]\n    rfl\n#align mem_smooth_fiberwise_linear_iff mem_smooth_fiberwise_linear_iff\n\n",
 "locality_auxâ‚‚":
 "/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«exprâ‹ƒ , Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:210:13: unsupported notation `Â«exprâ‹ƒ , Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â‰ƒL[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â‰ƒL[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Tactic/Builtin.lean:73:14: unsupported tactic `congrm #[[expr (_, _)]] -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â‰ƒL[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â‰ƒL[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/-- Let `e` be a local homeomorphism of `B Ã— F` whose source is `U Ã—Ë¢ univ`, for some set `U` in\n`B`, and which, at any point `x` in `U`, admits a neighbourhood `u` of `x` such that `e` is equal on\n`u Ã—Ë¢ univ` to some bi-smooth fiberwise linear local homeomorphism.  Then `e` itself is equal to\nsome bi-smooth fiberwise linear local homeomorphism.\n\nThis is the key mathematical point of the `locality` condition in the construction of the\n`structure_groupoid` of bi-smooth fiberwise linear local homeomorphisms.  The proof is by gluing\ntogether the various bi-smooth fiberwise linear local homeomorphism which exist locally.\n\nThe `U` in the conclusion is the same `U` as in the hypothesis. We state it like this, because this\nis exactly what we need for `smooth_fiberwise_linear`. -/\ntheorem smooth_fiberwise_linear.locality_auxâ‚‚ (e : LocalHomeomorph (B Ã— F) (B Ã— F)) (U : Set B)\n    (hU : e.source = lower_set.prod U univ)\n    (h :\n      âˆ€ x âˆˆ U,\n        âˆƒ (Ï† : B â†’ Â«expr â‰ƒL[ ] Â» F ğ•œ F)(u : Set B)(hu : IsOpen u)(hUu : u âŠ† U)(hux : x âˆˆ u)(hÏ† :\n          smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => (Ï† x : Â«expr â†’L[ ] Â» F ğ•œ F)) u)(h2Ï† :\n          smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => ((Ï† x).symm : Â«expr â†’L[ ] Â» F ğ•œ F))\n            u),\n          (e.restr (lower_set.prod u univ)).eq_on_source\n            (fiberwise_linear.local_homeomorph Ï† hu hÏ†.continuous_on h2Ï†.continuous_on)) :\n    âˆƒ (Î¦ : B â†’ Â«expr â‰ƒL[ ] Â» F ğ•œ F)(U : Set B)(hUâ‚€ : IsOpen U)(hÎ¦ :\n      smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => (Î¦ x : Â«expr â†’L[ ] Â» F ğ•œ F)) U)(h2Î¦ :\n      smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => ((Î¦ x).symm : Â«expr â†’L[ ] Â» F ğ•œ F)) U),\n      e.eq_on_source (fiberwise_linear.local_homeomorph Î¦ hUâ‚€ hÎ¦.continuous_on h2Î¦.continuous_on) :=\n  by\n  classical\n    rw [SetCoe.forall'] at h\n    choose! Ï† u hu hUu hux hÏ† h2Ï† heÏ† using h\n    have heuÏ† : âˆ€ x : U, eq_on e (fun q => (q.1, Ï† x q.1 q.2)) (lower_set.prod (u x) univ) :=\n      by\n      intro x p hp\n      refine' (heÏ† x).2 _\n      rw [(heÏ† x).1]\n      exact hp\n    have huÏ† : âˆ€ (x x' : U) (y : B) (hyx : y âˆˆ u x) (hyx' : y âˆˆ u x'), Ï† x y = Ï† x' y :=\n      by\n      intro p p' y hyp hyp'\n      ext v\n      have h1 : e (y, v) = (y, Ï† p y v) := heuÏ† _ âŸ¨(id hyp : (y, v).fst âˆˆ u p), trivialâŸ©\n      have h2 : e (y, v) = (y, Ï† p' y v) := heuÏ† _ âŸ¨(id hyp' : (y, v).fst âˆˆ u p'), trivialâŸ©\n      exact congr_arg Prod.snd (h1.symm.trans h2)\n    have hUu' :\n      U = Â«exprâ‹ƒ , Â» \"./././Mathport/Syntax/Translate/Expr.lean:210:13: unsupported notation `Â«exprâ‹ƒ , Â»\" (u i) :=\n      by\n      ext x\n      rw [mem_Union]\n      refine' âŸ¨fun h => âŸ¨âŸ¨x, hâŸ©, hux _âŸ©, _âŸ©\n      rintro âŸ¨x, hxâŸ©\n      exact hUu x hx\n    have hU' : IsOpen U := by\n      rw [hUu']\n      apply isOpen_unionáµ¢ hu\n    let Î¦â‚€ : U â†’ Â«expr â‰ƒL[ ] Â» F ğ•œ F := Union_lift u (fun x => Ï† x âˆ˜ coe) huÏ† U hUu'.le\n    let Î¦ : B â†’ Â«expr â‰ƒL[ ] Â» F ğ•œ F := fun y => if hy : y âˆˆ U then Î¦â‚€ âŸ¨y, hyâŸ© else ContinuousLinearEquiv.refl ğ•œ F\n    have hÎ¦ : âˆ€ (y) (hy : y âˆˆ U), Î¦ y = Î¦â‚€ âŸ¨y, hyâŸ© := fun y hy => dif_pos hy\n    have hÎ¦Ï† : âˆ€ x : U, âˆ€ y âˆˆ u x, Î¦ y = Ï† x y := by\n      intro x y hyu\n      refine' (hÎ¦ y (hUu x hyu)).trans _\n      exact Union_lift_mk âŸ¨y, hyuâŸ© _\n    have hÎ¦ : smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun y => (Î¦ y : Â«expr â†’L[ ] Â» F ğ•œ F)) U :=\n      by\n      apply cont_mdiff_on_of_locally_cont_mdiff_on\n      intro x hx\n      refine' âŸ¨u âŸ¨x, hxâŸ©, hu âŸ¨x, hxâŸ©, hux _, _âŸ©\n      refine' (cont_mdiff_on.congr (hÏ† âŸ¨x, hxâŸ©) _).mono (inter_subset_right _ _)\n      intro y hy\n      rw [hÎ¦Ï† âŸ¨x, hxâŸ© y hy]\n    have h2Î¦ :\n      smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun y => ((Î¦ y).symm : Â«expr â†’L[ ] Â» F ğ•œ F)) U :=\n      by\n      apply cont_mdiff_on_of_locally_cont_mdiff_on\n      intro x hx\n      refine' âŸ¨u âŸ¨x, hxâŸ©, hu âŸ¨x, hxâŸ©, hux _, _âŸ©\n      refine' (cont_mdiff_on.congr (h2Ï† âŸ¨x, hxâŸ©) _).mono (inter_subset_right _ _)\n      intro y hy\n      rw [hÎ¦Ï† âŸ¨x, hxâŸ© y hy]\n    refine' âŸ¨Î¦, U, hU', hÎ¦, h2Î¦, hU, fun p hp => _âŸ©\n    rw [hU] at hp\n    -- using rw on the next line seems to cause a timeout in kernel type-checking\n    refine' (heuÏ† âŸ¨p.fst, hp.1âŸ© âŸ¨hux _, hp.2âŸ©).trans _\n    trace \"./././Mathport/Syntax/Translate/Tactic/Builtin.lean:73:14: unsupported tactic `congrm #[[expr (_, _)]]\"\n    rw [hÎ¦Ï†]\n    apply hux\n#align smooth_fiberwise_linear.locality_auxâ‚‚ smooth_fiberwise_linear.locality_auxâ‚‚\n\n",
 "locality_auxâ‚":
 "/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr '' Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr '' Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â‰ƒL[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â‰ƒL[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `model_with_corners_self -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `Â«expr â†’L[ ] Â» -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:177:8: unsupported: ambiguous notation -/\n/- ./././Mathport/Syntax/Translate/Expr.lean:207:4: warning: unsupported notation `lower_set.prod -/\n/-- Let `e` be a local homeomorphism of `B Ã— F`.  Suppose that at every point `p` in the source of\n`e`, there is some neighbourhood `s` of `p` on which `e` is equal to a bi-smooth fiberwise linear\nlocal homeomorphism.\nThen the source of `e` is of the form `U Ã—Ë¢ univ`, for some set `U` in `B`, and, at any point `x` in\n`U`, admits a neighbourhood `u` of `x` such that `e` is equal on `u Ã—Ë¢ univ` to some bi-smooth\nfiberwise linear local homeomorphism. -/\ntheorem smooth_fiberwise_linear.locality_auxâ‚ (e : LocalHomeomorph (B Ã— F) (B Ã— F))\n    (h :\n      âˆ€ p âˆˆ e.source,\n        âˆƒ s : Set (B Ã— F),\n          IsOpen s âˆ§\n            p âˆˆ s âˆ§\n              âˆƒ (Ï† : B â†’ Â«expr â‰ƒL[ ] Â» F ğ•œ F)(u : Set B)(hu : IsOpen u)(hÏ† :\n                smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => (Ï† x : Â«expr â†’L[ ] Â» F ğ•œ F))\n                  u)(h2Ï† :\n                smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F))\n                  (fun x => ((Ï† x).symm : Â«expr â†’L[ ] Â» F ğ•œ F)) u),\n                (e.restr s).eq_on_source (fiberwise_linear.local_homeomorph Ï† hu hÏ†.continuous_on h2Ï†.continuous_on)) :\n    âˆƒ (U : Set B)(hU : e.source = lower_set.prod U univ),\n      âˆ€ x âˆˆ U,\n        âˆƒ (Ï† : B â†’ Â«expr â‰ƒL[ ] Â» F ğ•œ F)(u : Set B)(hu : IsOpen u)(huU : u âŠ† U)(hux : x âˆˆ u)(hÏ† :\n          smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => (Ï† x : Â«expr â†’L[ ] Â» F ğ•œ F)) u)(h2Ï† :\n          smooth_on IB (model_with_corners_self ğ•œ (Â«expr â†’L[ ] Â» F ğ•œ F)) (fun x => ((Ï† x).symm : Â«expr â†’L[ ] Â» F ğ•œ F))\n            u),\n          (e.restr (lower_set.prod u univ)).eq_on_source\n            (fiberwise_linear.local_homeomorph Ï† hu hÏ†.continuous_on h2Ï†.continuous_on) :=\n  by\n  rw [SetCoe.forall'] at h\n  -- choose s hs hsp Ï† u hu hÏ† h2Ï† heÏ† using h,\n  -- the following 2 lines should be `choose s hs hsp Ï† u hu hÏ† h2Ï† heÏ† using h,`\n  -- `choose` produces a proof term that takes a long time to type-check by the kernel (it seems)\n  -- porting note: todo: try using `choose` again in Lean 4\n  simp only [classical.skolem, â† exists_prop] at h\n  rcases h with âŸ¨s, hs, hsp, Ï†, u, hu, hÏ†, h2Ï†, heÏ†âŸ©\n  have hesu : âˆ€ p : e.source, e.source âˆ© s p = lower_set.prod (u p) univ :=\n    by\n    intro p\n    rw [â† e.restr_source' (s _) (hs _)]\n    exact (heÏ† p).1\n  have hu' : âˆ€ p : e.source, (p : B Ã— F).fst âˆˆ u p := by\n    intro p\n    have : (p : B Ã— F) âˆˆ e.source âˆ© s p := âŸ¨p.prop, hsp pâŸ©\n    simpa only [hesu, mem_prod, mem_univ, and_true_iff] using this\n  have heu : âˆ€ p : e.source, âˆ€ q : B Ã— F, q.fst âˆˆ u p â†’ q âˆˆ e.source :=\n    by\n    intro p q hq\n    have : q âˆˆ lower_set.prod (u p) (univ : Set F) := âŸ¨hq, trivialâŸ©\n    rw [â† hesu p] at this\n    exact this.1\n  have he : e.source = lower_set.prod (Â«expr '' Â» Prod.fst e.source) (univ : Set F) :=\n    by\n    apply HasSubset.Subset.antisymm\n    Â· intro p hp\n      exact âŸ¨âŸ¨p, hp, rflâŸ©, trivialâŸ©\n    Â· rintro âŸ¨x, vâŸ© âŸ¨âŸ¨p, hp, rfl : p.fst = xâŸ©, -âŸ©\n      exact heu âŸ¨p, hpâŸ© (p.fst, v) (hu' âŸ¨p, hpâŸ©)\n  refine' âŸ¨Â«expr '' Â» Prod.fst e.source, he, _âŸ©\n  rintro x âŸ¨p, hp, rflâŸ©\n  refine' âŸ¨Ï† âŸ¨p, hpâŸ©, u âŸ¨p, hpâŸ©, hu âŸ¨p, hpâŸ©, _, hu' _, hÏ† âŸ¨p, hpâŸ©, h2Ï† âŸ¨p, hpâŸ©, _âŸ©\n  Â· intro y hy\n    refine' âŸ¨(y, 0), heu âŸ¨p, hpâŸ© âŸ¨_, _âŸ© hy, rflâŸ©\n  Â· rw [â† hesu, e.restr_source_inter]\n    exact heÏ† âŸ¨p, hpâŸ©\n#align smooth_fiberwise_linear.locality_auxâ‚ smooth_fiberwise_linear.locality_auxâ‚\n\n"}